---
title: "STAT139 Final Project"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
winedata = read.csv('winemag-data-130k-v2.csv')
```

```{r}
newwinedata = read.csv('new_wine_data.csv')
```

```{r}
# create "Other' country
country_cat = vector()
for (i in 1:nrow(winedata)) {
  if (winedata$country[i] == 'Italy') {
    country_cat = c(country_cat,'Italy')
  }
  else if (winedata$country[i] == 'US') {
    country_cat = c(country_cat,'US')
  }
  else if (winedata$country[i] == 'France') {
    country_cat = c(country_cat,'France')
  }
  else if (winedata$country[i] == 'Spain') {
    country_cat = c(country_cat,'Spain')
  }
  else if (winedata$country[i] == 'Portugal') {
    country_cat = c(country_cat,'Portugal')
  }
  else if (winedata$country[i] == 'Austria') {
    country_cat = c(country_cat,'Austria')
  }
  else if (winedata$country[i] == 'Chile') {
    country_cat = c(country_cat,'Chile')
  }
  else if (winedata$country[i] == 'Argentina') {
    country_cat = c(country_cat,'Argentina')
  }
  else if (winedata$country[i] == 'Australia') {
    country_cat = c(country_cat,'Australia')
  }
  else if (winedata$country[i] == 'New Zealand') {
    country_cat = c(country_cat,'New Zealand')
  }
  else if (winedata$country[i] == 'Germany') {
    country_cat = c(country_cat,'Germany')
  }
  else {
    country_cat = c(country_cat, 'Other')
  }
}
```


```{r}
# extract year
cleanyear = vector()
for (i in 1:nrow(newwinedata)) {
  if (is.na(newwinedata$title[i])) {
    cleanyear = c(cleanyear,NA)
  }
  else if (as.numeric(newwinedata$title[i]) < 1700) {
    cleanyear = c(cleanyear,NA)
  }
  else if (as.numeric(newwinedata$title[i]) > 2018) {
    cleanyear = c(cleanyear,NA)
  }
  else {
    cleanyear = c(cleanyear,as.numeric(newwinedata$title[i]))
  }
}
```


```{r}
# add columns to dataframe
winedata$countrycat = country_cat
winedata$year = cleanyear
```

```{r}
plot(winedata$price,winedata$points)
hist(winedata$points)
```

```{r}
plot(winedata$year,winedata$points)
```

```{r}
model1 = lm(points~countrycat+year+taster_name+log(price),data=winedata)
summary(model1)
```


